# Применение методов машинного обучения для управления инвестиционным портфелем на Московской бирже

## Описание проекта

В проекте реализован подход к **прогнозированию краткосрочного направления движения цены акций ПАО «Сбербанк»** на основе исторических рыночных данных, технических индикаторов и алгоритмов машинного обучения (CatBoost, LightGBM, XGBoost).

## Актуальность

Современные финансовые рынки требуют высокой точности анализа и адаптивности стратегий. Интеграция ML-алгоритмов с классическими методами позволяет получать конкурентные преимущества в управлении портфелем и трейдинге.

## Цели и задачи

- **Цель**: Разработать и внедрить ML-подход для прогнозирования направления цены акций Сбербанка.
- **Задачи**:
    - Сбор и подготовка исторических данных, расчет технических индикаторов.
    - Формирование целевой переменной и признакового пространства.
    - Обучение и настройка моделей CatBoost, LightGBM, XGBoost.
    - Ансамблирование моделей (majority voting) для повышения точности.
    - Оценка эффективности (валидизация, backtesting, сравнение с Buy&Hold).
    - Автоматизация всего жизненного цикла модели с помощью инструментов MLOps (Docker, MLflow, Kubernetes, Terraform, GitHub Actions).

## Методы и инструменты

- **Датасет**: Исторические данные по акциям Сбербанка (MOEX, 2015–2025), ~30 000 строк, 1-часовой интервал.
- **Признаки**: Цены, объемы, EMA, ADX, RSI, ATR и другие технические индикаторы.
- **ML-модели**: CatBoost, LightGBM, XGBoost; ансамблирование через majority voting.
- **Feature engineering**: Автоматический расчет признаков, оптимизация целевой переменной (выбор лага по ACF).
- **Гиперпараметры**: Оптимизация через Optuna.
- **Оценка качества**: Accuracy, F1, Precision, Recall, доходность стратегии, сравнение с Buy&Hold.
- **MLOps**: MLflow, Docker, FastAPI, Kubernetes, Terraform, GitHub Actions.

## Ключевые результаты

- Модель показывает лучшие параметры риска и доходности по сравнению с Buy&Hold.
- Внедрён автоматизированный MLOps-пайплайн для обучения, инференса и логирования моделей.
- Подход масштабируем и применим для других инструментов и рынков.

## Научная новизна и значимость

- Интеграция ансамбля ML-моделей и автоматизированной инфраструктуры MLOps.
- Оценка на реальных данных Московской биржи.
- Готовность к внедрению в финтех, трейдинг, ПИФы, банки.

## Перспективы развития

- Адаптация для других акций и рынков.
- Добавление макроэкономических, фундаментальных и новостных факторов.
- Исследование RL-агентов и портфельных стратегий.
- Разработка интерфейса для инвесторов.

---

> **Студент:** Минаков Максим Михайлович  
> **Научный руководитель:** Крылов Сергей Сергеевич, МАИ, кафедра 806
> **Текст ВКР:** https://docs.google.com/document/d/19Sso60_9_xlu5YiysuScDPgr60rx01Uu/edit
> **Презентация:** https://docs.google.com/presentation/d/1OpCmgUhPoV6r2Xgxu69-pcxkHeqbsIY7auYWuEYRMJc/edit?slide=id.g2954c97530a_0_0#slide=id.g2954c97530a_0_0